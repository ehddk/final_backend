{"version":3,"file":"validation.middleware.js","sourceRoot":"","sources":["../../../../src/__api/common/middlewares/validation.middleware.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA,yCAA2B;AAE3B,4FAAmE;AAEnE,wBAAwB;AACjB,MAAM,QAAQ,GACnB,CACE,MAMK,EACL,EAAE,CACJ,KAAK,EAAE,GAAY,EAAE,EAAY,EAAE,IAAkB,EAAE,EAAE;IACvD,IAAI,CAAC;QACH,IAAI,MAAM,YAAY,GAAG,CAAC,YAAY,EAAE,CAAC;YACvC,MAAM,MAAM,CAAC,QAAQ,EAAE,CAAC;gBACtB,IAAI,EAAE,GAAG,CAAC,IAAI;gBACd,IAAI,EAAE,GAAG,CAAC,MAAM;gBAChB,MAAM,EAAE,GAAG,CAAC,KAAK;aAClB,EAAG,EAAE,UAAU,EAAE,KAAK,EAAE,CACxB,CAAC;QACJ,CAAC;aAAM,CAAC;YACN,MAAM,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YACzC,MAAM,MAAM,EAAE,IAAI,EAAE,QAAQ,EAAE,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAC3C,MAAM,MAAM,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;QAC9C,CAAC;QAED,OAAO,IAAI,EAAE,CAAC;IAChB,CAAC;IAAC,OAAO,KAAU,EAAE,CAAC;QACpB,IAAI,KAAK,YAAY,GAAG,CAAC,eAAe,EAAE,CAAC;YACzC,qCAAqC;YACrC,IAAI,CAAC,IAAI,wBAAa,CAAC,GAAG,EAAE,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAChD,CAAC;aAAM,CAAC;YACN,IAAI,CAAC,IAAI,wBAAa,CAAC,GAAG,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC;QAC9C,CAAC;IACH,CAAC;AACH,CAAC,CAAC;AAlCS,QAAA,QAAQ,YAkCjB","sourcesContent":["import * as yup from \"yup\";\nimport type { Request, Response, NextFunction } from \"express\";\nimport HttpException from \"@/api/common/exceptions/http.exception\";\n\n/** 모든 요청 validate 체크 */\nexport const validate =\n  (\n    schema:\n      | yup.AnyObject\n      | {\n          body?: yup.AnyObject;\n          path?: yup.AnyObject;\n          params?: yup.AnyObject;\n        }\n  ) =>\n  async (req: Request, __: Response, next: NextFunction) => {\n    try {\n      if (schema instanceof yup.ObjectSchema) {\n        await schema.validate?.({\n          body: req.body,\n          path: req.params,\n          params: req.query,\n        } , { abortEarly: false }  \n        );\n      } else {\n        await schema?.body?.validate?.(req.body);\n        await schema?.path?.validate?.(req.params);\n        await schema?.params?.validate?.(req.query);\n      }\n\n      return next();\n    } catch (error: any) {\n      if (error instanceof yup.ValidationError) {\n        // ValidationError인 경우 첫 번째 에러 메시지 반환\n        next(new HttpException(400, error.errors[0]));\n      } else {\n        next(new HttpException(400, error.message));\n      }\n    }\n  };\n"]}